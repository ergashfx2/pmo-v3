import random
import uuid
from django.core.management.base import BaseCommand
from django.contrib.auth.models import User
from django.utils import timezone
from faker import Faker
from myapp.models import Project, Profile, Team

class Command(BaseCommand):
    help = 'Generate fake data for Projects, Profiles, and Teams'

    def handle(self, *args, **kwargs):
        fake = Faker()

        # Create 50 Users and Profiles
        for _ in range(50):
            username = fake.user_name()
            email = fake.email()
            user = User.objects.create_user(username=username, email=email, password='password')
            profile = Profile.objects.get(user_id=user)
            profile.first_name = fake.first_name()
            profile.last_name = fake.last_name()
            profile.position = fake.job()
            profile.role = fake.random_element(elements=('Developer', 'Manager', 'Designer'))
            profile.phone = fake.phone_number()
            profile.blog = fake.url()
            profile.department = fake.random_element(elements=('IT', 'HR', 'Finance'))
            profile.save()

        # Create 10 Teams
        teams = []
        for _ in range(10):
            team = Team.objects.create(
                id=uuid.uuid4(),
                name=fake.company(),
                external_user=fake.name()
            )
            teams.append(team)

        # Create 50 Projects
        for _ in range(50):
            project = Project.objects.create(
                id=uuid.uuid4(),
                number=fake.random_number(digits=6),
                name=fake.bs(),
                blog=fake.random_element(elements=('Tech', 'Business', 'Lifestyle')),
                departments=fake.random_element(elements=('IT', 'HR', 'Finance')),
                size=fake.random_element(elements=('Small', 'Medium', 'Large')),
                level=fake.random_element(elements=('Junior', 'Mid', 'Senior')),
                speed=fake.random_element(elements=('Slow', 'Normal', 'Fast')),
                type=fake.random_element(elements=('Internal', 'External')),
                team=random.choice(teams),
                description=fake.text(),
                termination=fake.random_number(digits=1),
                start_date=timezone.now(),
                deadline=fake.date_this_year(),
                budget=fake.random_number(digits=8),
                status=fake.random_element(elements=('Planned', 'In Progress', 'Completed')),
                spent_money=fake.random_number(digits=7)
            )
            project.author.set(User.objects.order_by('?')[:random.randint(1, 3)])  # Random authors
